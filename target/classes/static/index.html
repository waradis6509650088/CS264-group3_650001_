<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Login</title>
    <link rel="icon" href="pic/TU.png" type="image/png">

    <link rel="stylesheet" type="text/css" href="loginStyle.css">
    <body>
        <div class="login">
        <from id="apiForm">
            <h2>LOGIN</h2>
            <label for="username">ชื่อผู้ใช้:</label>
            <input type="text" id="username" name="UserName" placeholder="รหัศนักศึกษา" required><br>

            <label for="password">รหัสผ่าน:</label>
            <input type="password" id="password" name="PassWord" placeholder="เลขประจำตัวบัตรประชาชน"required><br>
            <div id="apiResponse"></div>
            <button type="submit" onclick="login()">เข้าสู่ระบบ</button>
        </from>
            <script>
            const apiResponse = document.getElementById('apiResponse');

            function login(){

                // รับข้อมูลจากฟอร์ม

                // สร้าง JSON จากข้อมูลฟอร์ม
                const jsonData = {
                    'UserName' : document.getElementById("username").value,
                    'PassWord' : document.getElementById("password").value,
                }

                // ส่งข้อมูลไปยัง API
                sendDataToAPI(jsonData);
            }

            function sendDataToAPI(data) {
                // URL ของ API
                const apiUrl = 'https://restapi.tu.ac.th/api/v1/auth/Ad/verify2';

                // สร้างคำขอ POST โดยใช้ Fetch API
                fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Application-Key': 'TU0f64211521a97b3ce427005e4fc094f5924b4d2f652762c20613966d60d48858a12dbe883a7461b845c1d7fd2d4290ba', // แทนด้วยคีย์แอปพลิเคชันของคุณ
                    },
                    body: JSON.stringify(data)
                    })
                    .then(response => response.json())
                    .then(responseData => {
                    if (responseData.status && responseData.type == "student") {
                        // ทำการนำทางไปยังหน้าอื่น ๆ หากมีข้อมูลถูกต้อง
                        window.location.href = 'form.html';
                    } else {
                        // ไม่พบข้อมูลหรือข้อมูลไม่ถูกต้อง
                        apiResponse.innerHTML = 'ไม่พบข้อมูลหรือข้อมูลไม่ถูกต้อง';
                    }
                    })
                    .catch(error => {
                        console.error('เกิดข้อผิดพลาดในการเรียกใช้ API:', error);
                        apiResponse.innerHTML = 'เกิดข้อผิดพลาดในการเรียกใช้ API';
                    });
            }
            </script>
        </div>
    </body>

</html>

